<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Survey HTML </title>

  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/css/bootstrap.min.css">
  <link rel="stylesheet" href="css/style.css">
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css">
  <script src="https://code.jquery.com/jquery.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"></script>


</head>

<body id="surveyBody">
  <div class="container">

    <h2>Survey Questions</h2>

    <hr>
    <div class="col-lg-12">

      <div class="panel panel-default">
        <div class="panel-heading">
          <h3 class="panel-title">
            <strong>About You</strong>
          </h3>
        </div>
        <div class="panel-body">
          <form method="POST" role="form">

            <div class="form-group">
              <label for="formGroupExampleInput">Name (Required)</label>
              <input type="text" class="form-control" id="friendName" placeholder="">
            </div>

            <form>

              <div class="form-group">
                <label for="formGroupExampleInput2">Link to Photo Image (Required)</label>
                <input type="text" class="form-control" id="friendPic" placeholder="">
              </div>

            </form>

            <h5>Question 1</h5>
            <h4>Must Love Pitt Bulls!!</h4>

            <select class="custom-select" id="q1value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>

            <h5>Question 2</h5>
            <h4>Must Love the Movie Tombstone!!</h4>

            <select class="custom-select" id="q2value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>

            <h5>Question 3</h5>
            <h4>Hot Dogs and Bolonga are the Enemy?</h4>

            <select class="custom-select" id="q3value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 4</h5>
            <h4>Do you enjoy outdoor activities, kayaking, hiking, camping etc.......</h4>

            <select class="custom-select" id="q4value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 5</h5>
            <h4>I believe that Quality Time is the most Important aspect of a relationship!!</h4>

            <select class="custom-select" id="q5value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>

            <h5>Question 6</h5>
            <h4>Must Love Kansas Jayhawk Basketball</h4>

            <select class="custom-select" id="q6value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 7</h5>
            <h4>It's Okay to Eat off My plate in public or at home</h4>

            <select class="custom-select" id="q7value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 8</h5>
            <h4>Do you think housework is equal for both partners?</h4>

            <select class="custom-select" id="q8value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 9</h5>
            <h4>A few Dog hairs here and their isn't a big deal......</h4>

            <select class="custom-select" id="q9value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>
              <br>
            </select>
            <br>
            <h5>Question 10</h5>
            <h4>Vacationing is the best and I want to do much more..........</h4>

            <select class="custom-select" id="q10value">
              <option selected>Select an Option...</option>
              <option value="1">1 (Strongly Disagree)</option>
              <option value="2">2</option>
              <option value="3">3</option>
              <option value="4">4</option>
              <option value="5">5 (Stongly Agree)</option>

            </select>
            <br>

            <br>
            

            <button type="Submit" class="btn btn-primary btn-lg btn block" id="Submit" data-toggle="modal" data-target="#friendModal">Submit</button>
            <br>

            <br>

            <div class="modal fade" id="friendModal" tabindex="-1" role="dialog" aria-labelledbye="exampleModalLabel" aria-hidden="true">
              <div class="modal-dialog" role="document">
                <div class="modal-content">
                  <div class="modal-header">
                    <h2 class="modal-title" id="exampleModalLabel">Meet your New Best Friend!</h2>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                      <span aria-hidden="true">&times;</span>

                    </button>

                  </div>
                  <div class="modal-body">

                    <h3 id="trueFriendName"></h3>

                    <img id="img" src="">



                  </div>



                  <div class="modal-footer">

                    <button type="button" class="btn btn-secondary" data-dismiss="modal" id="closeModal">
                      <a href="/survey">Close</a>
                    </button>

                  </div>

                </div>

              </div>

            </div>

            <footer>
              <div class="container">
                <p>
                  <a href="/api/friends">API Friends List |
                    <a href="https:///github.com/alykat44/friendfinder">GitHub Repo</a>

                </p>
            



            </footer>

            </form>
            </div>






    <script type="text/javascript">

      var newFriend;
      var scores;
      var newFriendscores;
      var add = [];
      var allScores = [];
      var counter = 0;
      var sumArray = [];





      $("#Submit").on("click", function () {
        event.preventDefault();

        scores = [];

        newFriend = {
          name: $("#friendName").val().trim(),
          link: $("#friendPic").val().trim(),
          responses: scores
        };


        var questionOne = parseInt($("#q1value").val());
        var questionTwo = parseInt($("#q2value").val());
        var questionThree = parseInt($("#q3value").val());
        var questionFour = parseInt($("#q4value").val());
        var questionFive = parseInt($("#q5value").val());
        var questionSix = parseInt($("#q6value").val());
        var questionSeven = parseInt($("#q7value").val());
        var questionEight = parseInt($("#q8value").val());
        var questionNine = parseInt($("#q9value").val());
        var questionTen = parseInt($("#q10value").val());


        scores.push(questionOne);
        scores.push(questionTwo);
        scores.push(questionThree);
        scores.push(questionFour);
        scores.push(questionFive);
        scores.push(questionSix);
        scores.push(questionSeven);
        scores.push(questionEight);
        scores.push(questionNine);
        scores.push(questionTen);


        // console.log(newFriend);

        newFriendScores = newFriend.responses;
        // console.log(newFriendscores);


        getFriends();


      });

      $("#closeModal").on("click", function () {
        
        $("#friendName").val("");
        $("#friendPic").val("");
        $(".custom-select").val("Select an Option....");

        add = [];
        sum = 0;
        startingSum = 100;
        allScores = [];

        $.post("/api/friends", newFriend, function (data) { });

      });

      function getFriends() {

        var currentURL = window.location.origin;



        $.ajax({ url: currentURL + "/api/friends", method: "GET" })
          .done(function (friendsArray) {



            console.log("--------------------------------------");
            console.log("URL: " + currentURL + "/api/friends");
            console.log("--------------------------------------");

            console.log(friendsArray);
            console.log("--------------------------------------");

            // console.log(newFriendScores);

            // loop through allScores Array to get each index score

            for (var j = 0; j < friendsArray.length; j++) {
              add = [];
              sum = 0;
              startingSum = 100;

              var responses = friendsArray[j].responses;
              allScores.push(responses);

              console.log(allScores);

              var currentFriend = allScores[j];



              //  index of newly entered friend's scores with prepopulated friends to see result and differences

              for (var i = 0; i < 10; i++) {

                var newFriendIndex = newFriendScores[i];
                var currentFriendIndex = currentFriend[i];
                var difference = Math.abs(newFriendIndex - currentFriendIndex);
                add.push(difference);
              }
              // Math.abs runs the absolute value of a number

              // i loop closing

              // Adding all user input to check for closet match

              sum = add.reduce(function (a, b) {
                return a + b;

              }, 0);

              console.log(sum);

              if (sum < startingSum) {
                startingSum = sum;

                trueFriend = {
                  friendName: friendsArray[j].name,
                  friendPhoto: friendsArray[j].link
                };




              }

            }

            // Closeing j loop

            $("trueFriendName").text(trueFriend.friendName);
            console.log(trueFriend.friendName)

            var friendpic = trueFriend.friendPhoto;
            $("#img").attr("src", friendpic);
            console.log(trueFriend);

          });

      }


    </script>

    <script src="https://code.jquery.com/jquery-3.2.1.min.js" integrity="sha256-hwg4gsxgFZhOsEEamdOYGBf13FyQuiTwlAQgxVSNgt4="
      crossorigin="anonymous"></script>

</body>

</html>